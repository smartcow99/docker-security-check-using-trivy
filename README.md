# Docker-security-check-using-Trivy

![image](https://github.com/user-attachments/assets/d73ba76b-c9f5-416d-9683-ada643f1339d)

> ##### [Trivy](https://trivy.dev/) is a comprehensive and versatile security scanner. 
> ##### íŠ¸ë¦¬ë¹„ëŠ” í¬ê´„ì ì´ê³  ë‹¤ì¬ë‹¤ëŠ¥í•œ ë³´ì•ˆ ìŠ¤ìºë„ˆì…ë‹ˆë‹¤.  

<br>

**íŠ¸ë¦¬ë¹„ì˜ íƒ€ê²ŸğŸš€**:

 - Container Image
 - Filesystem
 - Git Repository (remote)
 - Virtual Machine Image
 - Kubernetes
 - AWS

**íŠ¸ë¦¬ë¹„ê°€ ì°¾ì„ ìˆ˜ ìˆëŠ” ë¬¸ì œì ë“¤â—**:

 - OS packages and software dependencies in use (SBOM)
 - Known vulnerabilities (CVEs)
 - IaC issues and misconfigurations
 - Sensitive information and secrets
 - Software licenses


## ì‹¤ìŠµ
> ##### Docker Container Imageë¥¼ ëŒ€ìƒìœ¼ë¡œ ì·¨ì•½ì  ê²€ì‚¬

#### 1. 
```bash
> docker run aquasec/trivy
```

> Main.java
```java
public class Main{
        public static void main(String [] args) {
                System.out.println("Image Build by DockerFile!");
        }
}
```

> Dockerfile
```bash
FROM openjdk:17
COPY . /usr/src/myapp
WORKDIR /usr/src/myapp
RUN javac Main.java
CMD ["java", "Main"]
```

```bash
> docker build -t trivytest
```

```bash
> docker run --rm -v /var/run/docker.sock:/var/run/docker.sock aquasec/trivy image --severity HIGH,CRITICAL trivytest
```

| ë¼ì´ë¸ŒëŸ¬ë¦¬  | ì·¨ì•½ì   | ì‹¬ê°ë„ | ë¬¸ì œ ì„¤ëª…  | í•´ê²° ë°©ë²•  | ì„¤ì¹˜ëœ ë²„ì „  | ìˆ˜ì •ëœ ë²„ì „  |
|-------------|---------|--------|------------|------------|--------------|--------------|
| expat       | CVE-2022-40674 | HIGH | `xmlparse.c`ì˜ `doContent` í•¨ìˆ˜ì—ì„œ ë°œìƒí•˜ëŠ” Use-after-free ì·¨ì•½ì . ì´ë¡œ ì¸í•´ ë©”ëª¨ë¦¬ ì†ìƒì´ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë©°, ì ì¬ì ìœ¼ë¡œ ì•…ìš©ë  ê°€ëŠ¥ì„±ì´ ìˆìŒ. | ìµœì‹  ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ì—¬ í•´ë‹¹ ì·¨ì•½ì ì„ ìˆ˜ì •í•¨. | 2.2.5-4.0.1.el8_5.3 | 2.2.5-8.0.1.el8_6.3 |
| glibc       | CVE-2023-4527  | HIGH | `getaddrinfo` í•¨ìˆ˜ì—ì„œ `no-aaaa` ëª¨ë“œë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ìŠ¤íƒ ì½ê¸° ì˜¤ë²„í”Œë¡œìš°. ì˜ëª»ëœ DNS ì‘ë‹µìœ¼ë¡œ ì¸í•´ ì‹œìŠ¤í…œì— ì†ìƒì„ ì¤„ ìˆ˜ ìˆìŒ. | í•´ë‹¹ ë¬¸ì œë¥¼ í•´ê²°í•œ íŒ¨ì¹˜ ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸. | 2.28-164.0.5.el8_5.3 | 2.28-225.0.4.el8_8.6 |
| glibc       | CVE-2023-4806  | MEDIUM | `getaddrinfo()` í•¨ìˆ˜ì—ì„œ ë°œìƒí•˜ëŠ” Use-after-free ì·¨ì•½ì . ë©”ëª¨ë¦¬ ì†ìƒìœ¼ë¡œ ì¸í•´ ì•…ì„± ì½”ë“œ ì‹¤í–‰ì˜ ìœ„í—˜ì´ ìˆìŒ. | í•´ë‹¹ ë¬¸ì œë¥¼ í•´ê²°í•œ ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸. | 2.28-164.0.5.el8_5.3 | 2.28-225.0.4.el8_8.6 |
| glibc       | CVE-2023-4813  | MEDIUM | `gaih_inet()` í•¨ìˆ˜ì—ì„œ ë°œìƒí•˜ëŠ” Use-after-free ì·¨ì•½ì . ì‹œìŠ¤í…œì´ ë¹„ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œë  ìˆ˜ ìˆëŠ” ë¬¸ì œë¥¼ ìœ ë°œí•¨. | ì—…ë°ì´íŠ¸ëœ íŒ¨ì¹˜ ì ìš©. | 2.28-164.0.5.el8_5.3 | 2.28-225.0.4.el8_8.6 |
| glibc       | CVE-2023-4911  | HIGH | `ld.so`ì—ì„œ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ê°€ ë°œìƒí•˜ì—¬ ê¶Œí•œ ìƒìŠ¹ì˜ ìœ„í—˜ì´ ìˆìŒ. | ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ë¬¸ì œë¥¼ í•´ê²°í•œ ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸. | 2.28-164.0.5.el8_5.3 | 2.28-225.0.4.el8_8.6 |
| glibc       | CVE-2024-2961  | HIGH | `iconv`ì—ì„œ ë°œìƒí•˜ëŠ” Out-of-bounds ì“°ê¸° ì·¨ì•½ì . ì´ë¡œ ì¸í•´ ì›ê²© ì½”ë“œ ì‹¤í–‰ì´ ë°œìƒí•  ìˆ˜ ìˆìŒ. | í•´ë‹¹ ì·¨ì•½ì ì„ í•´ê²°í•œ ìµœì‹  ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸. | 2.28-164.0.5.el8_5.3 | 2.28-251.0.2.el8_10.1 |
| glibc       | CVE-2024-33599 | HIGH | `netgroup` ìºì‹œì—ì„œ ìŠ¤íƒ ê¸°ë°˜ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ê°€ ë°œìƒí•˜ì—¬ ì‹œìŠ¤í…œì´ ë¹„ì •ìƒì ìœ¼ë¡œ ë™ì‘í•  ìˆ˜ ìˆìŒ. | íŒ¨ì¹˜ëœ ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•„ìš”. | 2.28-164.0.5.el8_5.3 | 2.28-251.0.2.el8_10.2 |
| glibc       | CVE-2024-33600 | MEDIUM | `netgroup` ìºì‹œ ì‹¤íŒ¨ ì‹œ null í¬ì¸í„° ì—­ì°¸ì¡°ë¡œ ì¸í•´ ì‹œìŠ¤í…œì´ ë¹„ì •ìƒ ì¢…ë£Œë  ìˆ˜ ìˆìŒ. | í•´ë‹¹ ë¬¸ì œë¥¼ í•´ê²°í•œ íŒ¨ì¹˜ ì ìš©. | 2.28-164.0.5.el8_5.3 | 2.28-251.0.2.el8_10.2 |
| glibc       | CVE-2024-33601 | MEDIUM | `netgroup` ìºì‹œì˜ ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨ ì‹œ ë°ëª¬ì´ ì¢…ë£Œë  ìˆ˜ ìˆìŒ. | íŒ¨ì¹˜ëœ ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸. | 2.28-164.0.5.el8_5.3 | 2.28-251.0.2.el8_10.2 |
| glibc       | CVE-2024-33602 | LOW | `NSS` ì½œë°±ì´ ë²„í¼ ë‚´ ë¬¸ìì—´ì„ ì‚¬ìš©í•  ê²ƒì´ë¼ê³  ê°€ì •í•˜ì—¬ ë°œìƒí•˜ëŠ” ë¬¸ì œ. | ìµœì‹  ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ì—¬ ë¬¸ì œ í•´ê²°. | 2.28-164.0.5.el8_5.3 | 2.28-251.0.2.el8_10.2 |
| glibc-minimal-langpack| CVE-2023-4527  | MEDIUM | `getaddrinfo`ì˜ no-aaaa ëª¨ë“œì—ì„œ ìŠ¤íƒ ì½ê¸° ì˜¤ë²„í”Œë¡œìš° ë°œìƒ                                      | ìµœì‹  glibc íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                                   | 2.28-225.0.4.el8_8.6    | 2.28-251.0.2.el8_10.1  |
| glibc-minimal-langpack| CVE-2023-4806  | MEDIUM   | `getaddrinfo()`ì—ì„œ ì ì¬ì ì¸ use-after-free ì·¨ì•½ì                                               | ìµœì‹  glibc íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                                   | 2.28-225.0.4.el8_8.6    | 2.28-251.0.2.el8_10.1  |
| glibc-minimal-langpack| CVE-2023-4813  | MEDIUM | `gaih_inet()`ì—ì„œ ì ì¬ì ì¸ use-after-free ì·¨ì•½ì                                                 | ìµœì‹  glibc íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                                   | 2.28-225.0.4.el8_8.6    | 2.28-251.0.2.el8_10.1  |
| glibc-minimal-langpack| CVE-2023-4911  | HIGH | `ld.so`ì—ì„œì˜ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¡œ ì¸í•œ ê¶Œí•œ ìƒìŠ¹ ë¬¸ì œ ë°œìƒ                                        | ìµœì‹  glibc íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                                   | 2.28-225.0.4.el8_8.6    | 2.28-251.0.2.el8_10.1  |
| glibc-minimal-langpack| CVE-2024-2961  | HIGH | `iconv`ì—ì„œì˜ ê²½ê³„ ë°– ì“°ê¸°ë¡œ ì¸í•´ ì›ê²© ì½”ë“œ ì‹¤í–‰ ê°€ëŠ¥ì„± ë°œìƒ                                   | ìµœì‹  glibc íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                                   | 2.28-225.0.4.el8_8.6    | 2.28-251.0.2.el8_10.1  |
| krb5-libs             | CVE-2022-42898 | MEDIUM | `PAC` êµ¬ë¬¸ ë¶„ì„ì—ì„œ ì •ìˆ˜ ì˜¤ë²„í”Œë¡œìš° ì·¨ì•½ì ìœ¼ë¡œ ì¸í•œ ë³´ì•ˆ ë¬¸ì œ                                  | ìµœì‹  krb5 íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                                    | 1.18.2-14.0.1.el8       | 1.18.2-22.0.1.el8_7    |
| libgcc                | CVE-2022-40982 | MEDIUM | ì¸í…” `Gather Data Sampling`(GDS) ì‚¬ì´ë“œ ì±„ë„ ì·¨ì•½ì                                              | ìµœì‹  libgcc íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                                   | 8.5.0-4.0.2.el8_5       | 8.5.0-18.0.5.el8       |
| libgcrypt             | CVE-2021-40528 | HIGH | `ElGamal` êµ¬í˜„ì—ì„œ í‰ë¬¸ ë³µêµ¬ ê°€ëŠ¥ì„± ë¬¸ì œ ë°œìƒ                                                   | ìµœì‹  libgcrypt íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                               | 1.8.5-6.el8             | 1.8.5-7.el8_6_fips     |
| libksba               | CVE-2022-3515  | HIGH | ì •ìˆ˜ ì˜¤ë²„í”Œë¡œìš°ë¡œ ì¸í•´ ì›ê²© ì½”ë“œ ì‹¤í–‰ ê°€ëŠ¥ì„± ë°œìƒ                                               | ìµœì‹  libksba íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                                 | 1.3.5-7.el8             | 1.3.5-8.el8_6          |
| libnghttp2            | CVE-2023-44487 | MEDIUM | ì—¬ëŸ¬ HTTP/2 ì§€ì› ì›¹ ì„œë²„ê°€ DDoS ê³µê²©ì— ì·¨ì•½í•¨                                                   | ìµœì‹  libnghttp2 íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                              | 1.33.0-3.el8_2.1        | 1.33.0-5.el8_8         |
| openssl-libs          | CVE-2022-4304  | MEDIUM | RSA ë³µí˜¸í™” êµ¬í˜„ì—ì„œì˜ íƒ€ì´ë° ê³µê²© ë¬¸ì œ ë°œìƒ                                                     | ìµœì‹  openssl íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                                 | 1.1.1k-6.el8_5          | 1.1.1k-9.el8_7         |
| systemd-libs          | CVE-2022-2526  | MEDIUM | `DnsStream` ì²˜ë¦¬ ì‹œ ë°œìƒí•˜ëŠ” use-after-free ì·¨ì•½ì  ë°œìƒ                                         | ìµœì‹  systemd-libs íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                            | 239-51.0.1.el8_5.5      | 239-58.0.1.el8_6.4     |
| xz-libs               | CVE-2022-1271  | MEDIUM | gzipì—ì„œ ì„ì˜ íŒŒì¼ ì“°ê¸° ì·¨ì•½ì  ë°œìƒ                                                             | ìµœì‹  xz-libs íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                                 | 5.2.4-3.el8             | 5.2.4-4.el8_6          |
| zlib                  | CVE-2018-25032 | MEDIUM | `zlib`ì—ì„œ íŠ¹ì • ì…ë ¥ì„ ì••ì¶•í•  ë•Œ ë°œìƒí•˜ëŠ” ë³´ì•ˆ ë¬¸ì œ                                              | ìµœì‹  zlib íŒ¨í‚¤ì§€ë¡œ ì—…ë°ì´íŠ¸                                    | 1.2.11-17.el8           | 1.2.11-18.el8_5        |

## TroubleshootingğŸ”¥
> ##### ì´ë¯¸ì§€ê°€ ë¡œì»¬ì— ìˆì§€ë§Œ, Trivyê°€ ì´ë¯¸ì§€ë¥¼ ì›ê²© ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ ì°¾ìœ¼ë ¤ê³  ì‹œë„í•˜ëŠ” ë¬¸ì œ ë°œìƒğŸ¤¦â€â™‚ï¸
- trivytestë¼ëŠ” ì´ë¯¸ì§€ëŠ” ë¡œì»¬ì—ì„œ í™•ì¸ë˜ì§€ë§Œ, Trivyê°€ í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ì›ê²© ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ ì°¾ìœ¼ë ¤ê³  ì‹œë„í•˜ëŠ” ë¬¸ì œë¥¼ `-v /var/run/docker.sock:/var/run/docker.sock`ì„ í†µí•´ docker ë°©ì‹ì„ ëª…ì‹œì ìœ¼ë¡œ ì§€ì •í•˜ê³  ë¡œì»¬ ì´ë¯¸ì§€ë¥¼ ìŠ¤ìº”í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ë¬¸ì œ í•´ê²°
```bash
> docker run --rm -v /var/run/docker.sock:/var/run/docker.sock aquasec/trivy image --severity HIGH,CRITICAL trivytest
```
